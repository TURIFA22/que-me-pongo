<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>¿Qué me pongo? - Tu Asistente de Moda con IA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
      .gradient-bg {
          background: linear-gradient(135deg, #f3e8ff 0%, #fce7f3 100%);
      }
      .gradient-text {
          background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
      }
      .gradient-btn {
          background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%);
          transition: all 0.3s ease;
      }
      .gradient-btn:hover {
          transform: translateY(-1px);
          box-shadow: 0 10px 25px rgba(147, 51, 234, 0.3);
      }
      .tab-active {
          color: #9333ea;
          border-bottom: 2px solid #9333ea;
          background: linear-gradient(135deg, #f3e8ff 0%, #fce7f3 100%);
      }
      .outfit-selected {
          border: 3px solid #9333ea;
          background: linear-gradient(135deg, #f3e8ff 0%, #fce7f3 100%);
          transform: scale(1.05);
      }
      .avatar-container {
          background: linear-gradient(180deg, #dbeafe 0%, #f3e8ff 100%);
      }
      .hidden { display: none; }
      .clothing-item {
          transition: all 0.3s ease;
          cursor: pointer;
          border-radius: 12px;
      }
      .clothing-item:hover {
          transform: translateY(-4px);
          box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      }
      .modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          backdrop-filter: blur(5px);
      }
      .modal-content {
          background: white;
          padding: 2rem;
          border-radius: 20px;
          max-width: 450px;
          width: 90%;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
          animation: modalSlideIn 0.3s ease-out;
      }
      @keyframes modalSlideIn {
          from {
              opacity: 0;
              transform: translateY(-50px) scale(0.9);
          }
          to {
              opacity: 1;
              transform: translateY(0) scale(1);
          }
      }
      .glass-card {
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .premium-badge {
          background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
          animation: pulse 2s infinite;
      }
      @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
      }
      .stats-card {
          background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
          border: 1px solid #e2e8f0;
          transition: all 0.3s ease;
      }
      .stats-card:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      }
      .weather-widget {
          background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
          color: white;
          border-radius: 12px;
          padding: 8px 12px;
      }
      .notification {
          position: fixed;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #10b981 0%, #059669 100%);
          color: white;
          padding: 12px 20px;
          border-radius: 12px;
          z-index: 1001;
          animation: slideInRight 0.3s ease-out;
      }
      @keyframes slideInRight {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
      }
      .floating-action {
          position: fixed;
          bottom: 20px;
          right: 20px;
          width: 60px;
          height: 60px;
          border-radius: 50%;
          background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%);
          color: white;
          border: none;
          font-size: 24px;
          cursor: pointer;
          box-shadow: 0 8px 25px rgba(147, 51, 234, 0.4);
          transition: all 0.3s ease;
          z-index: 100;
      }
      .floating-action:hover {
          transform: scale(1.1);
          box-shadow: 0 12px 35px rgba(147, 51, 234, 0.6);
      }
      .trend-badge {
          background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
          color: white;
          font-size: 10px;
          padding: 2px 6px;
          border-radius: 8px;
          position: absolute;
          top: -5px;
          right: -5px;
          animation: bounce 1s infinite;
      }
      @keyframes bounce {
          0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
          40% { transform: translateY(-10px); }
          60% { transform: translateY(-5px); }
      }
  </style>
</head>
<body class="gradient-bg min-h-screen">
  <!-- Header Mejorado -->
  <header class="glass-card shadow-lg border-b backdrop-blur-md">
      <div class="max-w-md mx-auto px-4 py-4">
          <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                  <div class="w-10 h-10 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center">
                      <i class="fas fa-tshirt text-white text-lg"></i>
                  </div>
                  <div>
                      <h1 class="text-xl font-bold gradient-text">¿Qué me pongo?</h1>
                      <p class="text-xs text-gray-500">Tu stylist con IA</p>
                  </div>
              </div>
              <div class="flex items-center gap-3">
                  <div id="user-info" class="hidden">
                      <button onclick="showProfile()" class="flex items-center gap-2 text-sm hover:bg-purple-50 p-2 rounded-lg transition-colors">
                          <div id="user-avatar" class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-sm"></div>
                          <div class="hidden sm:block text-left">
                              <p id="user-name" class="font-medium text-sm"></p>
                              <p class="text-xs text-gray-500"><span id="user-points-header">0</span> pts</p>
                          </div>
                      </button>
                  </div>
                  <button id="login-btn" onclick="showAuthModal()" class="gradient-btn text-white px-4 py-2 rounded-lg text-sm font-medium hover:shadow-lg transition-all">
                      <i class="fas fa-user mr-1"></i>
                      Entrar
                  </button>
                  <div class="weather-widget text-xs">
                      <div class="flex items-center gap-1">
                          <i class="fas fa-sun"></i>
                          <span id="weather-temp">22°C</span>
                      </div>
                      <div id="weather-condition" class="text-xs opacity-90">Soleado</div>
                  </div>
              </div>
          </div>
      </div>
  </header>

  <!-- Navigation Mejorada -->
  <nav class="glass-card border-b backdrop-blur-md">
      <div class="max-w-md mx-auto px-4">
          <div class="flex space-x-1">
              <button onclick="showTab('wardrobe')" id="tab-wardrobe" class="tab-btn flex-1 flex flex-col items-center py-3 px-2 text-xs font-medium transition-all rounded-t-lg tab-active">
                  <i class="fas fa-tshirt text-lg mb-1"></i>
                  Mi Closet
                  <div class="w-1 h-1 bg-purple-600 rounded-full mt-1"></div>
              </button>
              <button onclick="showTab('avatar')" id="tab-avatar" class="tab-btn flex-1 flex flex-col items-center py-3 px-2 text-xs font-medium transition-all rounded-t-lg text-gray-500 hover:text-purple-600">
                  <i class="fas fa-eye text-lg mb-1"></i>
                  Probador
              </button>
              <button onclick="showTab('community')" id="tab-community" class="tab-btn flex-1 flex flex-col items-center py-3 px-2 text-xs font-medium transition-all rounded-t-lg text-gray-500 hover:text-purple-600 relative">
                  <i class="fas fa-users text-lg mb-1"></i>
                  Comunidad
                  <span class="trend-badge">HOT</span>
              </button>
              <button onclick="showTab('challenges')" id="tab-challenges" class="tab-btn flex-1 flex flex-col items-center py-3 px-2 text-xs font-medium transition-all rounded-t-lg text-gray-500 hover:text-purple-600">
                  <i class="fas fa-trophy text-lg mb-1"></i>
                  Desafíos
              </button>
          </div>
      </div>
  </nav>

  <div class="max-w-md mx-auto px-4 py-6">
      <!-- Mi Closet Tab Mejorado -->
      <div id="wardrobe-tab" class="tab-content">
          <!-- Header con estadísticas -->
          <div class="glass-card rounded-xl p-4 mb-6 shadow-lg">
              <div class="flex items-center justify-between mb-4">
                  <div>
                      <h2 class="text-xl font-bold gradient-text">Mi Closet Virtual</h2>
                      <p class="text-sm text-gray-600">Organiza y crea looks increíbles</p>
                  </div>
                  <button onclick="generateRandomOutfit()" class="gradient-btn text-white px-4 py-2 rounded-xl flex items-center gap-2 font-medium shadow-lg">
                      <i class="fas fa-magic"></i>
                      Sorpréndeme
                  </button>
              </div>
              
              <!-- Mini estadísticas -->
              <div class="grid grid-cols-3 gap-3">
                  <div class="stats-card rounded-lg p-3 text-center">
                      <i class="fas fa-tshirt text-purple-600 text-lg mb-1"></i>
                      <p class="text-lg font-bold text-gray-800" id="total-clothes">11</p>
                      <p class="text-xs text-gray-500">Prendas</p>
                  </div>
                  <div class="stats-card rounded-lg p-3 text-center">
                      <i class="fas fa-palette text-pink-600 text-lg mb-1"></i>
                      <p class="text-lg font-bold text-gray-800" id="total-outfits">0</p>
                      <p class="text-xs text-gray-500">Outfits</p>
                  </div>
                  <div class="stats-card rounded-lg p-3 text-center">
                      <i class="fas fa-heart text-red-500 text-lg mb-1"></i>
                      <p class="text-lg font-bold text-gray-800" id="total-likes">0</p>
                      <p class="text-xs text-gray-500">Likes</p>
                  </div>
              </div>
          </div>

          <!-- Recomendación IA -->
          <div class="glass-card rounded-xl p-4 mb-6 border-l-4 border-purple-500">
              <div class="flex items-start gap-3">
                  <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                      <i class="fas fa-robot text-white"></i>
                  </div>
                  <div class="flex-1">
                      <h3 class="font-semibold text-gray-800 mb-1">Recomendación IA</h3>
                      <p class="text-sm text-gray-600" id="ai-recommendation">Para el clima de hoy, te recomiendo un look casual con colores frescos. ¡Prueba combinando azul y blanco!</p>
                  </div>
              </div>
          </div>

          <!-- Categorías de ropa mejoradas -->
          <div class="space-y-6">
              <!-- Parte Superior -->
              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-4 text-white">
                      <h3 class="text-lg font-semibold flex items-center gap-2">
                          <i class="fas fa-tshirt"></i>
                          Parte Superior
                      </h3>
                      <p class="text-sm opacity-90">Camisas, blusas, tops y más</p>
                  </div>
                  <div class="p-4">
                      <div class="grid grid-cols-2 gap-4" id="tops-container">
                          <!-- Se llena con JavaScript -->
                      </div>
                  </div>
              </div>

              <!-- Parte Inferior -->
              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="bg-gradient-to-r from-blue-500 to-purple-500 p-4 text-white">
                      <h3 class="text-lg font-semibold flex items-center gap-2">
                          <i class="fas fa-user-tie"></i>
                          Parte Inferior
                      </h3>
                      <p class="text-sm opacity-90">Pantalones, faldas, shorts</p>
                  </div>
                  <div class="p-4">
                      <div class="grid grid-cols-2 gap-4" id="bottoms-container">
                          <!-- Se llena con JavaScript -->
                      </div>
                  </div>
              </div>

              <!-- Calzado -->
              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="bg-gradient-to-r from-green-500 to-blue-500 p-4 text-white">
                      <h3 class="text-lg font-semibold flex items-center gap-2">
                          <i class="fas fa-shoe-prints"></i>
                          Calzado
                      </h3>
                      <p class="text-sm opacity-90">Zapatos, botas, zapatillas</p>
                  </div>
                  <div class="p-4">
                      <div class="grid grid-cols-2 gap-4" id="shoes-container">
                          <!-- Se llena con JavaScript -->
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- Probador Virtual Tab Mejorado -->
      <div id="avatar-tab" class="tab-content hidden">
          <div class="text-center mb-6">
              <h2 class="text-2xl font-bold gradient-text mb-2">Probador Virtual</h2>
              <p class="text-gray-600">Ve cómo se ve tu outfit antes de usarlo</p>
          </div>

          <div class="glass-card rounded-xl shadow-xl p-6 avatar-container">
              <div class="flex flex-col items-center">
                  <!-- Avatar mejorado -->
                  <div class="relative w-52 h-72 bg-white rounded-2xl shadow-2xl mb-6 overflow-hidden border-4 border-white">
                      <div class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-blue-50 to-purple-50">
                          <!-- Cabeza -->
                          <div class="w-14 h-14 bg-gradient-to-r from-pink-200 to-purple-200 rounded-full mb-3 shadow-lg"></div>

                          <!-- Torso -->
                          <div class="w-24 h-28 bg-gray-100 rounded-xl mb-3 flex items-center justify-center relative shadow-lg" id="avatar-top">
                              <span class="text-xs text-gray-400 font-medium">Selecciona Top</span>
                          </div>

                          <!-- Piernas -->
                          <div class="w-20 h-24 bg-gray-100 rounded-xl mb-3 flex items-center justify-center shadow-lg" id="avatar-bottom">
                              <span class="text-xs text-gray-400 font-medium">Selecciona Bottom</span>
                          </div>

                          <!-- Pies -->
                          <div class="w-16 h-10 bg-gray-100 rounded-xl flex items-center justify-center shadow-lg" id="avatar-shoes">
                              <span class="text-xs text-gray-400 font-medium">Zapatos</span>
                          </div>
                      </div>
                  </div>

                  <!-- Outfit Details mejorado -->
                  <div class="w-full space-y-4" id="outfit-details" style="display: none;">
                      <div class="glass-card rounded-xl p-4">
                          <h3 class="font-bold text-center text-lg gradient-text mb-3">✨ Tu Look de Hoy ✨</h3>
                          <div class="space-y-2 text-sm" id="outfit-list">
                              <!-- Se llena con JavaScript -->
                          </div>
                          
                          <!-- Rating del outfit -->
                          <div class="flex justify-center mt-4">
                              <div class="flex items-center gap-1">
                                  <span class="text-sm text-gray-600">Rating IA:</span>
                                  <div class="flex text-yellow-400">
                                      <i class="fas fa-star"></i>
                                      <i class="fas fa-star"></i>
                                      <i class="fas fa-star"></i>
                                      <i class="fas fa-star"></i>
                                      <i class="far fa-star"></i>
                                  </div>
                                  <span class="text-sm text-gray-600 ml-1">4.2/5</span>
                              </div>
                          </div>
                      </div>

                      <div class="grid grid-cols-2 gap-3">
                          <button onclick="saveOutfit()" class="glass-card border border-purple-200 text-purple-700 px-4 py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-purple-50 transition-all font-medium">
                              <i class="fas fa-heart"></i>
                              Guardar
                          </button>
                          <button onclick="shareOutfit()" class="gradient-btn text-white px-4 py-3 rounded-xl flex items-center justify-center gap-2 font-medium shadow-lg">
                              <i class="fas fa-share"></i>
                              Compartir
                          </button>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- Comunidad Tab Mejorado -->
      <div id="community-tab" class="tab-content hidden">
          <div class="flex items-center justify-between mb-6">
              <div>
                  <h2 class="text-xl font-bold gradient-text">Comunidad</h2>
                  <p class="text-sm text-gray-600">Descubre y comparte looks increíbles</p>
              </div>
              <button onclick="showUploadModal()" class="gradient-btn text-white px-4 py-2 rounded-xl text-sm flex items-center gap-2 font-medium shadow-lg">
                  <i class="fas fa-plus"></i>
                  Subir Look
              </button>
          </div>

          <!-- Top Users mejorado -->
          <div class="glass-card rounded-xl shadow-lg mb-6 overflow-hidden">
              <div class="bg-gradient-to-r from-yellow-400 to-orange-500 p-4 text-white">
                  <h3 class="font-semibold flex items-center gap-2">
                      <i class="fas fa-trophy"></i>
                      Top Stylists de la Semana
                  </h3>
              </div>
              <div class="p-4 space-y-3">
                  <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-purple-50 transition-colors">
                      <div class="premium-badge text-white px-2 py-1 rounded text-xs font-bold">#1</div>
                      <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center font-bold text-white">A</div>
                      <div class="flex-1">
                          <p class="font-medium">Ana M.</p>
                          <p class="text-xs text-gray-500">1,234 likes • Influencer</p>
                      </div>
                      <button class="text-purple-600 text-sm font-medium">Seguir</button>
                  </div>
                  <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-purple-50 transition-colors">
                      <span class="bg-gray-400 text-white px-2 py-1 rounded text-xs font-bold">#2</span>
                      <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center font-bold text-white">C</div>
                      <div class="flex-1">
                          <p class="font-medium">Carlos R.</p>
                          <p class="text-xs text-gray-500">987 likes • Pro</p>
                      </div>
                      <button class="text-purple-600 text-sm font-medium">Seguir</button>
                  </div>
                  <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-purple-50 transition-colors">
                      <span class="bg-gray-400 text-white px-2 py-1 rounded text-xs font-bold">#3</span>
                      <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center font-bold text-white">M</div>
                      <div class="flex-1">
                          <p class="font-medium">María L.</p>
                          <p class="text-xs text-gray-500">856 likes • Trendsetter</p>
                      </div>
                      <button class="text-purple-600 text-sm font-medium">Seguir</button>
                  </div>
              </div>
          </div>

          <!-- Trending Looks -->
          <h3 class="font-bold mb-4 flex items-center gap-2">
              <i class="fas fa-fire text-red-500"></i>
              Looks Trending
          </h3>
          <div class="space-y-4" id="community-looks">
              <!-- Se llena con JavaScript -->
          </div>
      </div>

      <!-- Desafíos Tab Mejorado -->
      <div id="challenges-tab" class="tab-content hidden">
          <div class="text-center mb-6">
              <h2 class="text-2xl font-bold gradient-text mb-2">Desafíos de Estilo</h2>
              <p class="text-gray-600">Completa desafíos y gana puntos</p>
          </div>

          <!-- Progreso del usuario -->
          <div class="glass-card rounded-xl p-4 mb-6 bg-gradient-to-r from-purple-50 to-pink-50">
              <div class="flex items-center justify-between mb-3">
                  <h3 class="font-semibold">Tu Progreso</h3>
                  <span class="text-sm text-purple-600 font-medium">Nivel 1</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                  <div class="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full" style="width: 30%"></div>
              </div>
              <p class="text-xs text-gray-600">30/100 puntos para el siguiente nivel</p>
          </div>

          <!-- Desafíos disponibles -->
          <div class="space-y-4 mb-6">
              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="p-4">
                      <div class="flex justify-between items-start mb-3">
                          <div class="flex items-center gap-3">
                              <div class="w-12 h-12 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center">
                                  <i class="fas fa-palette text-white"></i>
                              </div>
                              <div>
                                  <h3 class="font-semibold">Look Monocromático</h3>
                                  <p class="text-sm text-gray-600">Crea un outfit usando solo un color</p>
                              </div>
                          </div>
                          <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-medium">Fácil</span>
                      </div>
                      <div class="flex justify-between items-center">
                          <div class="flex items-center gap-4">
                              <span class="text-sm font-medium text-purple-600">+50 puntos</span>
                              <span class="text-xs text-gray-500">⏱️ 2 días restantes</span>
                          </div>
                          <button onclick="startChallenge(1)" class="gradient-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Participar</button>
                      </div>
                  </div>
              </div>

              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="p-4">
                      <div class="flex justify-between items-start mb-3">
                          <div class="flex items-center gap-3">
                              <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                                  <i class="fas fa-mix text-white"></i>
                              </div>
                              <div>
                                  <h3 class="font-semibold">Mezcla de Estilos</h3>
                                  <p class="text-sm text-gray-600">Combina casual con formal</p>
                              </div>
                          </div>
                          <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-xs font-medium">Medio</span>
                      </div>
                      <div class="flex justify-between items-center">
                          <div class="flex items-center gap-4">
                              <span class="text-sm font-medium text-purple-600">+100 puntos</span>
                              <span class="text-xs text-gray-500">⏱️ 5 días restantes</span>
                          </div>
                          <button onclick="startChallenge(2)" class="gradient-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Participar</button>
                      </div>
                  </div>
              </div>

              <div class="glass-card rounded-xl shadow-lg overflow-hidden">
                  <div class="p-4">
                      <div class="flex justify-between items-start mb-3">
                          <div class="flex items-center gap-3">
                              <div class="w-12 h-12 bg-gradient-to-r from-red-400 to-pink-500 rounded-full flex items-center justify-center">
                                  <i class="fas fa-leaf text-white"></i>
                              </div>
                              <div>
                                  <h3 class="font-semibold">Outfit Sostenible</h3>
                                  <p class="text-sm text-gray-600">Usa solo ropa de segunda mano</p>
                              </div>
                          </div>
                          <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-xs font-medium">Difícil</span>
                      </div>
                      <div class="flex justify-between items-center">
                          <div class="flex items-center gap-4">
                              <span class="text-sm font-medium text-purple-600">+150 puntos</span>
                              <span class="text-xs text-gray-500">⏱️ 1 semana restante</span>
                          </div>
                          <button onclick="startChallenge(3)" class="gradient-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Participar</button>
                      </div>
                  </div>
              </div>
          </div>

          <!-- Estadísticas mejoradas -->
          <div class="glass-card rounded-xl shadow-lg overflow-hidden">
              <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-4 text-white">
                  <h3 class="font-semibold flex items-center gap-2">
                      <i class="fas fa-chart-line"></i>
                      Tus Estadísticas
                  </h3>
              </div>
              <div class="p-4">
                  <div class="grid grid-cols-2 gap-4 text-center">
                      <div class="stats-card rounded-lg p-4">
                          <i class="fas fa-star text-yellow-500 text-2xl mb-2"></i>
                          <p class="text-2xl font-bold text-purple-600" id="user-points">0</p>
                          <p class="text-sm text-gray-600">Puntos Totales</p>
                      </div>
                      <div class="stats-card rounded-lg p-4">
                          <i class="fas fa-trophy text-orange-500 text-2xl mb-2"></i>
                          <p class="text-2xl font-bold text-pink-600" id="user-challenges">0</p>
                          <p class="text-sm text-gray-600">Desafíos Completados</p>
                      </div>
                  </div>
                  <div class="mt-4 text-center">
                      <button onclick="showLeaderboard()" class="text-purple-600 text-sm font-medium hover:underline">
                          Ver ranking completo →
                      </button>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Floating Action Button -->
  <button class="floating-action" onclick="generateRandomOutfit()" title="Generar outfit aleatorio">
      <i class="fas fa-magic"></i>
  </button>

  <!-- Modales mejorados -->
  <!-- Modal de Autenticación -->
  <div id="auth-modal" class="modal hidden">
      <div class="modal-content">
          <div class="flex justify-between items-center mb-6">
              <div>
                  <h2 class="text-2xl font-bold gradient-text">¡Bienvenido!</h2>
                  <p class="text-gray-600">Tu stylist personal con IA te espera</p>
              </div>
              <button onclick="hideAuthModal()" class="text-gray-400 hover:text-gray-600 text-xl">
                  <i class="fas fa-times"></i>
              </button>
          </div>
          
          <div class="mb-6">
              <div class="flex bg-gray-100 rounded-lg p-1">
                  <button id="login-tab" onclick="showAuthTab('login')" class="flex-1 py-2 px-4 text-center rounded-md bg-white shadow-sm text-purple-600 font-medium transition-all">
                      Iniciar Sesión
                  </button>
                  <button id="register-tab" onclick="showAuthTab('register')" class="flex-1 py-2 px-4 text-center text-gray-500 transition-all">
                      Registrarse
                  </button>
              </div>
          </div>

          <!-- Login Form -->
          <div id="login-form" class="auth-form">
              <form onsubmit="handleLogin(event)">
                  <div class="mb-4">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Email</label>
                      <div class="relative">
                          <i class="fas fa-envelope absolute left-3 top-3 text-gray-400"></i>
                          <input type="email" id="login-email" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="tu@email.com">
                      </div>
                  </div>
                  <div class="mb-6">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Contraseña</label>
                      <div class="relative">
                          <i class="fas fa-lock absolute left-3 top-3 text-gray-400"></i>
                          <input type="password" id="login-password" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="••••••••">
                      </div>
                  </div>
                  <button type="submit" class="w-full gradient-btn text-white py-3 px-4 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all">
                      <i class="fas fa-sign-in-alt mr-2"></i>
                      Iniciar Sesión
                  </button>
              </form>
          </div>

          <!-- Register Form -->
          <div id="register-form" class="auth-form hidden">
              <form onsubmit="handleRegister(event)">
                  <div class="mb-4">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Nombre completo</label>
                      <div class="relative">
                          <i class="fas fa-user absolute left-3 top-3 text-gray-400"></i>
                          <input type="text" id="register-name" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="Tu nombre">
                      </div>
                  </div>
                  <div class="mb-4">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Email</label>
                      <div class="relative">
                          <i class="fas fa-envelope absolute left-3 top-3 text-gray-400"></i>
                          <input type="email" id="register-email" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="tu@email.com">
                      </div>
                  </div>
                  <div class="mb-4">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Contraseña</label>
                      <div class="relative">
                          <i class="fas fa-lock absolute left-3 top-3 text-gray-400"></i>
                          <input type="password" id="register-password" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="••••••••">
                      </div>
                  </div>
                  <div class="mb-6">
                      <label class="block text-gray-700 text-sm font-medium mb-2">Confirmar contraseña</label>
                      <div class="relative">
                          <i class="fas fa-lock absolute left-3 top-3 text-gray-400"></i>
                          <input type="password" id="register-confirm" required class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all" placeholder="••••••••">
                      </div>
                  </div>
                  <button type="submit" class="w-full gradient-btn text-white py-3 px-4 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all">
                      <i class="fas fa-user-plus mr-2"></i>
                      Crear Cuenta
                  </button>
              </form>
          </div>

          <div class="mt-6 text-center">
              <button onclick="hideAuthModal()" class="text-sm text-gray-500 hover:text-gray-700">
                  Continuar sin cuenta (funcionalidad limitada)
              </button>
          </div>
      </div>
  </div>

  <!-- Modal de Perfil Mejorado -->
  <div id="profile-modal" class="modal hidden">
      <div class="modal-content">
          <div class="flex justify-between items-center mb-6">
              <h2 class="text-2xl font-bold gradient-text">Mi Perfil</h2>
              <button onclick="hideProfile()" class="text-gray-400 hover:text-gray-600 text-xl">
                  <i class="fas fa-times"></i>
              </button>
          </div>
          
          <div class="text-center mb-6">
              <div class="relative inline-block">
                  <div id="profile-avatar" class="w-24 h-24 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-3xl mx-auto mb-4 shadow-lg"></div>
                  <button class="absolute -bottom-2 -right-2 w-8 h-8 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors">
                      <i class="fas fa-camera text-xs"></i>
                  </button>
              </div>
              <h3 id="profile-name" class="text-xl font-bold"></h3>
              <p id="profile-email" class="text-gray-600"></p>
              <div class="flex justify-center mt-2">
                  <span class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-xs font-medium">
                      <i class="fas fa-crown mr-1"></i>
                      Nivel 1
                  </span>
              </div>
          </div>

          <div class="grid grid-cols-3 gap-4 mb-6">
              <div class="text-center stats-card rounded-lg p-3">
                  <i class="fas fa-star text-yellow-500 text-xl mb-1"></i>
                  <p class="text-xl font-bold text-purple-600" id="profile-points">0</p>
                  <p class="text-xs text-gray-600">Puntos</p>
              </div>
              <div class="text-center stats-card rounded-lg p-3">
                  <i class="fas fa-tshirt text-purple-500 text-xl mb-1"></i>
                  <p class="text-xl font-bold text-pink-600" id="profile-outfits">0</p>
                  <p class="text-xs text-gray-600">Outfits</p>
              </div>
              <div class="text-center stats-card rounded-lg p-3">
                  <i class="fas fa-heart text-red-500 text-xl mb-1"></i>
                  <p class="text-xl font-bold text-red-600" id="profile-likes">0</p>
                  <p class="text-xs text-gray-600">Likes</p>
              </div>
          </div>

          <div class="space-y-3">
              <button class="w-full glass-card border border-purple-200 text-purple-700 py-3 px-4 rounded-lg hover:bg-purple-50 transition-all font-medium">
                  <i class="fas fa-edit mr-2"></i>
                  Editar Perfil
              </button>
              <button onclick="showPremiumModal()" class="w-full gradient-btn text-white py-3 px-4 rounded-lg font-medium shadow-lg">
                  <i class="fas fa-crown mr-2"></i>
                  Upgrade a Premium
              </button>
              <button onclick="handleLogout()" class="w-full border border-red-300 text-red-600 py-3 px-4 rounded-lg hover:bg-red-50 transition-all font-medium">
                  <i class="fas fa-sign-out-alt mr-2"></i>
                  Cerrar Sesión
              </button>
          </div>
      </div>
  </div>

  <!-- Modal Premium -->
  <div id="premium-modal" class="modal hidden">
      <div class="modal-content">
          <div class="text-center mb-6">
              <div class="w-16 h-16 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                  <i class="fas fa-crown text-white text-2xl"></i>
              </div>
              <h2 class="text-2xl font-bold gradient-text">¡Upgrade a Premium!</h2>
              <p class="text-gray-600">Desbloquea todo el potencial de tu stylist IA</p>
          </div>

          <div class="space-y-4 mb-6">
              <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
                  <i class="fas fa-check-circle text-purple-600"></i>
                  <span class="text-sm">Outfits ilimitados por día</span>
              </div>
              <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
                  <i class="fas fa-robot text-purple-600"></i>
                  <span class="text-sm">IA Stylist personal avanzado</span>
              </div>
              <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
                  <i class="fas fa-fire text-purple-600"></i>
                  <span class="text-sm">Acceso anticipado a trending</span>
              </div>
              <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
                  <i class="fas fa-chart-line text-purple-600"></i>
                  <span class="text-sm">Análisis de estilo completo</span>
              </div>
          </div>

          <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-4 rounded-xl text-white text-center mb-6">
              <div class="flex items-center justify-center gap-2 mb-2">
                  <span class="text-3xl font-bold">$4.99</span>
                  <span class="text-sm opacity-80">/mes</span>
                  <span class="bg-yellow-400 text-yellow-900 px-2 py-1 rounded text-xs font-bold ml-2">50% OFF</span>
              </div>
              <p class="text-sm opacity-90">Primer mes solo $2.49</p>
          </div>

          <div class="space-y-3">
              <button onclick="upgradeToPremium()" class="w-full gradient-btn text-white py-3 px-4 rounded-lg font-medium shadow-lg">
                  <i class="fas fa-crown mr-2"></i>
                  Upgrade Ahora
              </button>
              <button onclick="hidePremiumModal()" class="w-full text-gray-500 py-2">
                  Continuar con plan gratuito
              </button>
          </div>
      </div>
  </div>

  <!-- Tutorial Modal Mejorado -->
  <div id="tutorial-modal" class="modal hidden">
      <div class="modal-content">
          <div class="text-center mb-6">
              <div class="w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
                  <i class="fas fa-sparkles text-white text-3xl"></i>
              </div>
              <h2 class="text-2xl font-bold gradient-text">¡Bienvenido a ¿Qué me pongo?!</h2>
              <p class="text-gray-600 mt-2">Tu stylist personal con IA está listo para ayudarte</p>
          </div>

          <div class="space-y-4 mb-6">
              <div class="flex items-start gap-4 p-3 bg-purple-50 rounded-lg">
                  <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                      <i class="fas fa-tshirt text-white"></i>
                  </div>
                  <div>
                      <h3 class="font-semibold">Organiza tu armario</h3>
                      <p class="text-sm text-gray-600">Añade tus prendas y organízalas por categorías inteligentes</p>
                  </div>
              </div>

              <div class="flex items-start gap-4 p-3 bg-blue-50 rounded-lg">
                  <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                      <i class="fas fa-eye text-white"></i>
                  </div>
                  <div>
                      <h3 class="font-semibold">Probador virtual</h3>
                      <p class="text-sm text-gray-600">Ve cómo se ven tus outfits antes de vestirte</p>
                  </div>
              </div>

              <div class="flex items-start gap-4 p-3 bg-green-50 rounded-lg">
                  <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center">
                      <i class="fas fa-users text-white"></i>
                  </div>
                  <div>
                      <h3 class="font-semibold">Comunidad</h3>
                      <p class="text-sm text-gray-600">Comparte tus looks y descubre las últimas tendencias</p>
                  </div>
              </div>

              <div class="flex items-start gap-4 p-3 bg-yellow-50 rounded-lg">
                  <div class="w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center">
                      <i class="fas fa-trophy text-white"></i>
                  </div>
                  <div>
                      <h3 class="font-semibold">Desafíos</h3>
                      <p class="text-sm text-gray-600">Completa desafíos de estilo y gana puntos</p>
                  </div>
              </div>
          </div>

          <button onclick="hideTutorial()" class="w-full gradient-btn text-white py-3 px-4 rounded-lg font-medium shadow-lg">
              <i class="fas fa-rocket mr-2"></i>
              ¡Empezar a crear looks!
          </button>
      </div>
  </div>

  <script>
      // Datos de ropa predeterminada mejorados
      const clothingItems = {
          tops: [
              {
                  id: 1,
                  name: "Remera Básica",
                  color: "Blanco",
                  image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=150&h=150&fit=crop",
                  category: "casual",
                  brand: "Básica",
                  price: "$25"
              },
              {
                  id: 2,
                  name: "Buzo Oversize",
                  color: "Negro",
                  image: "https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=150&h=150&fit=crop",
                  category: "casual",
                  brand: "Urban",
                  price: "$45"
              },
              {
                  id: 3,
                  name: "Camisa Formal",
                  color: "Azul",
                  image: "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?w=150&h=150&fit=crop",
                  category: "formal",
                  brand: "Elegante",
                  price: "$60"
              },
              {
                  id: 4,
                  name: "Top Deportivo",
                  color: "Rosa",
                  image: "https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=150&h=150&fit=crop",
                  category: "deportivo",
                  brand: "Sport",
                  price: "$35"
              },
          ],
          bottoms: [
              {
                  id: 5,
                  name: "Jeans Clásico",
                  color: "Azul",
                  image: "https://images.unsplash.com/photo-1542272604-787c3835535d?w=150&h=150&fit=crop",
                  category: "casual",
                  brand: "Denim Co",
                  price: "$80"
              },
              {
                  id: 6,
                  name: "Pantalón Formal",
                  color: "Negro",
                  image: "https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=150&h=150&fit=crop",
                  category: "formal",
                  brand: "Formal",
                  price: "$90"
              },
              {
                  id: 7,
                  name: "Shorts Deportivos",
                  color: "Gris",
                  image: "https://images.unsplash.com/photo-1591195853828-11db59a44f6b?w=150&h=150&fit=crop",
                  category: "deportivo",
                  brand: "Active",
                  price: "$30"
              },
              {
                  id: 8,
                  name: "Falda Midi",
                  color: "Beige",
                  image: "https://images.unsplash.com/photo-1583496661160-fb5886a13d77?w=150&h=150&fit=crop",
                  category: "elegante",
                  brand: "Chic",
                  price: "$55"
              },
          ],
          shoes: [
              {
                  id: 9,
                  name: "Zapatillas",
                  color: "Blanco",
                  image: "https://images.unsplash.com/photo-1549298916-b41d501d3772?w=150&h=150&fit=crop",
                  category: "casual",
                  brand: "Sneakers",
                  price: "$120"
              },
              {
                  id: 10,
                  name: "Zapatos Formales",
                  color: "Negro",
                  image: "https://images.unsplash.com/photo-1614252369475-531eba835eb1?w=150&h=150&fit=crop",
                  category: "formal",
                  brand: "Classic",
                  price: "$150"
              },
              {
                  id: 11,
                  name: "Botas",
                  color: "Marrón",
                  image: "https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=150&h=150&fit=crop",
                  category: "casual",
                  brand: "Boots",
                  price: "$180"
              },
          ],
      };

      // Datos de la comunidad mejorados
      const communityLooks = [
          {
              id: 1,
              user: "Ana M.",
              avatar: "A",
              outfit: "Look Casual Primavera",
              likes: 124,
              comments: 23,
              image: "https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=150&h=200&fit=crop",
              trending: true,
              verified: true
          },
          {
              id: 2,
              user: "Carlos R.",
              avatar: "C",
              outfit: "Elegante para Oficina",
              likes: 89,
              comments: 15,
              image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=200&fit=crop",
              trending: false,
              verified: false
          },
          {
              id: 3,
              user: "María L.",
              avatar: "M",
              outfit: "Street Style Urbano",
              likes: 156,
              comments: 31,
              image: "https://images.unsplash.com/photo-1494790108755-2616c9c0e8e0?w=150&h=200&fit=crop",
              trending: true,
              verified: true
          },
      ];

      // Estado de la aplicación
      let selectedOutfit = {
          top: null,
          bottom: null,
          shoes: null,
      };

      let currentUser = null;
      let savedOutfits = [];

      // Funciones de notificación
      function showNotification(message, type = 'success') {
          const notification = document.createElement('div');
          notification.className = `notification ${type === 'error' ? 'bg-red-500' : 'bg-green-500'}`;
          notification.innerHTML = `
              <div class="flex items-center gap-2">
                  <i class="fas fa-${type === 'error' ? 'exclamation-circle' : 'check-circle'}"></i>
                  <span>${message}</span>
              </div>
          `;
          document.body.appendChild(notification);
          
          setTimeout(() => {
              notification.remove();
          }, 3000);
      }

      // Funciones de autenticación mejoradas
      function showAuthModal() {
          document.getElementById('auth-modal').classList.remove('hidden');
      }

      function hideAuthModal() {
          document.getElementById('auth-modal').classList.add('hidden');
      }

      function showAuthTab(tab) {
          const loginTab = document.getElementById('login-tab');
          const registerTab = document.getElementById('register-tab');
          const loginForm = document.getElementById('login-form');
          const registerForm = document.getElementById('register-form');

          if (tab === 'login') {
              loginTab.classList.add('bg-white', 'shadow-sm', 'text-purple-600', 'font-medium');
              loginTab.classList.remove('text-gray-500');
              registerTab.classList.remove('bg-white', 'shadow-sm', 'text-purple-600', 'font-medium');
              registerTab.classList.add('text-gray-500');
              loginForm.classList.remove('hidden');
              registerForm.classList.add('hidden');
          } else {
              registerTab.classList.add('bg-white', 'shadow-sm', 'text-purple-600', 'font-medium');
              registerTab.classList.remove('text-gray-500');
              loginTab.classList.remove('bg-white', 'shadow-sm', 'text-purple-600', 'font-medium');
              loginTab.classList.add('text-gray-500');
              registerForm.classList.remove('hidden');
              loginForm.classList.add('hidden');
          }
      }

      function handleLogin(event) {
          event.preventDefault();
          const email = document.getElementById('login-email').value;
          const password = document.getElementById('login-password').value;

          // Simulación de login
          currentUser = {
              name: email.split('@')[0],
              email: email,
              points: 127,
              outfits: 8,
              challenges: 3,
              likes: 45,
              level: 1
          };

          updateUserInterface();
          hideAuthModal();
          showNotification('¡Bienvenido de vuelta! 🎉');
          setTimeout(() => showTutorial(), 1000);
      }

      function handleRegister(event) {
          event.preventDefault();
          const name = document.getElementById('register-name').value;
          const email = document.getElementById('register-email').value;
          const password = document.getElementById('register-password').value;
          const confirm = document.getElementById('register-confirm').value;

          if (password !== confirm) {
              showNotification('Las contraseñas no coinciden', 'error');
              return;
          }

          // Simulación de registro
          currentUser = {
              name: name,
              email: email,
              points: 0,
              outfits: 0,
              challenges: 0,
              likes: 0,
              level: 1
          };

          updateUserInterface();
          hideAuthModal();
          showNotification('¡Cuenta creada exitosamente! 🎉');
          setTimeout(() => showTutorial(), 1000);
      }

      function handleLogout() {
          currentUser = null;
          savedOutfits = [];
          selectedOutfit = { top: null, bottom: null, shoes: null };
          updateUserInterface();
          updateAvatar();
          hideProfile();
          showNotification('Sesión cerrada correctamente');
      }

      function updateUserInterface() {
          const loginBtn = document.getElementById('login-btn');
          const userInfo = document.getElementById('user-info');
          const userAvatar = document.getElementById('user-avatar');
          const userName = document.getElementById('user-name');
          const userPoints = document.getElementById('user-points');
          const userPointsHeader = document.getElementById('user-points-header');
          const userChallenges = document.getElementById('user-challenges');

          if (currentUser) {
              loginBtn.classList.add('hidden');
              userInfo.classList.remove('hidden');
              userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
              userName.textContent = currentUser.name;
              userPoints.textContent = currentUser.points;
              userPointsHeader.textContent = currentUser.points;
              userChallenges.textContent = currentUser.challenges;
          } else {
              loginBtn.classList.remove('hidden');
              userInfo.classList.add('hidden');
              userPoints.textContent = '0';
              userPointsHeader.textContent = '0';
              userChallenges.textContent = '0';
          }
      }

      // Funciones de perfil mejoradas
      function showProfile() {
          if (!currentUser) return;

          document.getElementById('profile-avatar').textContent = currentUser.name.charAt(0).toUpperCase();
          document.getElementById('profile-name').textContent = currentUser.name;
          document.getElementById('profile-email').textContent = currentUser.email;
          document.getElementById('profile-points').textContent = currentUser.points;
          document.getElementById('profile-outfits').textContent = currentUser.outfits;
          document.getElementById('profile-likes').textContent = currentUser.likes;

          document.getElementById('profile-modal').classList.remove('hidden');
      }

      function hideProfile() {
          document.getElementById('profile-modal').classList.add('hidden');
      }

      // Funciones de premium
      function showPremiumModal() {
          document.getElementById('premium-modal').classList.remove('hidden');
      }

      function hidePremiumModal() {
          document.getElementById('premium-modal').classList.add('hidden');
      }

      function upgradeToPremium() {
          showNotification('¡Funcionalidad premium próximamente! 🚀');
          hidePremiumModal();
      }

      // Funciones de tutorial
      function showTutorial() {
          document.getElementById('tutorial-modal').classList.remove('hidden');
      }

      function hideTutorial() {
          document.getElementById('tutorial-modal').classList.add('hidden');
      }

      // Funciones de navegación mejoradas
      function showTab(tabName) {
          // Ocultar todas las pestañas
          document.querySelectorAll('.tab-content').forEach(tab => {
              tab.classList.add('hidden');
          });
          
          // Remover clase activa de todos los botones
          document.querySelectorAll('.tab-btn').forEach(btn => {
              btn.classList.remove('tab-active');
              btn.classList.add('text-gray-500');
              btn.querySelector('div')?.remove(); // Remover indicador
          });
          
          // Mostrar pestaña seleccionada
          document.getElementById(tabName + '-tab').classList.remove('hidden');
          
          // Activar botón seleccionado
          const activeBtn = document.getElementById('tab-' + tabName);
          activeBtn.classList.add('tab-active');
          activeBtn.classList.remove('text-gray-500');
          
          // Agregar indicador
          const indicator = document.createElement('div');
          indicator.className = 'w-1 h-1 bg-purple-600 rounded-full mt-1';
          activeBtn.appendChild(indicator);
      }

      // Función para seleccionar prenda mejorada
      function selectItem(item, type) {
          selectedOutfit[type] = item;
          
          // Actualizar UI del closet
          updateClothingSelection(type, item.id);
          
          // Actualizar avatar
          updateAvatar();
          
          // Mostrar notificación
          showNotification(`${item.name} seleccionado`);
          
          // Actualizar recomendación IA
          updateAIRecommendation();
      }

      // Actualizar selección visual en el closet
      function updateClothingSelection(type, itemId) {
          const container = document.getElementById(type === 'top' ? 'tops-container' : 
                                                 type === 'bottom' ? 'bottoms-container' : 'shoes-container');
          
          // Remover selección anterior
          container.querySelectorAll('.clothing-item').forEach(item => {
              item.classList.remove('outfit-selected');
          });
          
          // Agregar selección actual
          const selectedElement = container.querySelector(`[data-id="${itemId}"]`);
          if (selectedElement) {
              selectedElement.classList.add('outfit-selected');
          }
      }

      // Actualizar avatar mejorado
      function updateAvatar() {
          const avatarTop = document.getElementById('avatar-top');
          const avatarBottom = document.getElementById('avatar-bottom');
          const avatarShoes = document.getElementById('avatar-shoes');
          const outfitDetails = document.getElementById('outfit-details');
          const outfitList = document.getElementById('outfit-list');

          // Actualizar top
          if (selectedOutfit.top) {
              avatarTop.innerHTML = `<img src="${selectedOutfit.top.image}" alt="${selectedOutfit.top.name}" class="w-full h-full object-cover rounded-xl shadow-lg">`;
          } else {
              avatarTop.innerHTML = '<span class="text-xs text-gray-400 font-medium">Selecciona Top</span>';
          }

          // Actualizar bottom
          if (selectedOutfit.bottom) {
              avatarBottom.innerHTML = `<img src="${selectedOutfit.bottom.image}" alt="${selectedOutfit.bottom.name}" class="w-full h-full object-cover rounded-xl shadow-lg">`;
          } else {
              avatarBottom.innerHTML = '<span class="text-xs text-gray-400 font-medium">Selecciona Bottom</span>';
          }

          // Actualizar shoes
          if (selectedOutfit.shoes) {
              avatarShoes.innerHTML = `<img src="${selectedOutfit.shoes.image}" alt="${selectedOutfit.shoes.name}" class="w-full h-full object-cover rounded-xl shadow-lg">`;
          } else {
              avatarShoes.innerHTML = '<span class="text-xs text-gray-400 font-medium">Zapatos</span>';
          }

          // Mostrar detalles del outfit si hay algo seleccionado
          if (selectedOutfit.top || selectedOutfit.bottom || selectedOutfit.shoes) {
              outfitDetails.style.display = 'block';
              
              let outfitHTML = '';
              if (selectedOutfit.top) {
                  outfitHTML += `<div class="flex items-center gap-2 p-2 bg-purple-50 rounded-lg"><i class="fas fa-tshirt text-purple-600"></i><span>${selectedOutfit.top.name} ${selectedOutfit.top.color}</span></div>`;
              }
              if (selectedOutfit.bottom) {
                  outfitHTML += `<div class="flex items-center gap-2 p-2 bg-blue-50 rounded-lg"><i class="fas fa-user-tie text-blue-600"></i><span>${selectedOutfit.bottom.name} ${selectedOutfit.bottom.color}</span></div>`;
              }
              if (selectedOutfit.shoes) {
                  outfitHTML += `<div class="flex items-center gap-2 p-2 bg-green-50 rounded-lg"><i class="fas fa-shoe-prints text-green-600"></i><span>${selectedOutfit.shoes.name} ${selectedOutfit.shoes.color}</span></div>`;
              }
              
              outfitList.innerHTML = outfitHTML;
          } else {
              outfitDetails.style.display = 'none';
          }
      }

      // Generar outfit aleatorio mejorado
      function generateRandomOutfit() {
          const randomTop = clothingItems.tops[Math.floor(Math.random() * clothingItems.tops.length)];
          const randomBottom = clothingItems.bottoms[Math.floor(Math.random() * clothingItems.bottoms.length)];
          const randomShoes = clothingItems.shoes[Math.floor(Math.random() * clothingItems.shoes.length)];

          selectItem(randomTop, 'top');
          selectItem(randomBottom, 'bottom');
          selectItem(randomShoes, 'shoes');
          
          showNotification('¡Outfit aleatorio generado! ✨');
          
          // Cambiar a la pestaña del probador
          showTab('avatar');
      }

      // Funciones de outfit
      function saveOutfit() {
          if (!currentUser) {
              showNotification('Inicia sesión para guardar outfits', 'error');
              return;
          }
          
          if (!selectedOutfit.top && !selectedOutfit.bottom && !selectedOutfit.shoes) {
              showNotification('Selecciona al menos una prenda', 'error');
              return;
          }
          
          const outfit = {
              id: Date.now(),
              name: `Outfit ${savedOutfits.length + 1}`,
              items: { ...selectedOutfit },
              date: new Date().toISOString(),
              likes: 0
          };
          
          savedOutfits.push(outfit);
          currentUser.outfits++;
          updateUserInterface();
          showNotification('¡Outfit guardado exitosamente! 💾');
      }

      function shareOutfit() {
          if (!selectedOutfit.top && !selectedOutfit.bottom && !selectedOutfit.shoes) {
              showNotification('Selecciona al menos una prenda para compartir', 'error');
              return;
          }
          
          showNotification('¡Outfit compartido en la comunidad! 🌟');
          
          if (currentUser) {
              currentUser.points += 10;
              updateUserInterface();
          }
      }

      // Funciones de desafíos
      function startChallenge(challengeId) {
          if (!currentUser) {
              showNotification('Inicia sesión para participar en desafíos', 'error');
              return;
          }
          
          const challenges = {
              1: { name: 'Look Monocromático', points: 50 },
              2: { name: 'Mezcla de Estilos', points: 100 },
              3: { name: 'Outfit Sostenible', points: 150 }
          };
          
          const challenge = challenges[challengeId];
          showNotification(`¡Desafío "${challenge.name}" iniciado! Complétalo para ganar ${challenge.points} puntos 🏆`);
      }

      function showLeaderboard() {
          showNotification('Ranking completo próximamente 📊');
      }

      // Actualizar recomendación IA
      function updateAIRecommendation() {
          const recommendations = [
              "¡Excelente combinación! Los colores se complementan perfectamente.",
              "Para el clima de hoy, esta combinación es ideal.",
              "Considera agregar un accesorio para completar el look.",
              "Esta combinación es perfecta para una ocasión casual.",
              "¡Muy trendy! Este look está muy de moda.",
              "Combinación clásica que nunca pasa de moda."
          ];
          
          const randomRec = recommendations[Math.floor(Math.random() * recommendations.length)];
          document.getElementById('ai-recommendation').textContent = randomRec;
      }

      // Renderizar ropa mejorado
      function renderClothing() {
          // Renderizar tops
          const topsContainer = document.getElementById('tops-container');
          topsContainer.innerHTML = clothingItems.tops.map(item => `
              <div class="clothing-item cursor-pointer rounded-xl border-2 border-gray-200 p-4 transition-all hover:shadow-xl bg-white" 
                   data-id="${item.id}" onclick="selectItem(${JSON.stringify(item).replace(/"/g, '&quot;')}, 'top')">
                  <img src="${item.image}" alt="${item.name}" class="w-full h-24 object-cover rounded-lg mb-3 shadow-sm">
                  <div class="space-y-1">
                      <p class="font-semibold text-sm text-gray-800">${item.name}</p>
                      <p class="text-xs text-gray-500">${item.color} • ${item.brand}</p>
                      <div class="flex justify-between items-center">
                          <span class="inline-block bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 text-xs px-2 py-1 rounded-full font-medium">${item.category}</span>
                          <span class="text-xs font-bold text-green-600">${item.price}</span>
                      </div>
                  </div>
              </div>
          `).join('');

          // Renderizar bottoms
          const bottomsContainer = document.getElementById('bottoms-container');
          bottomsContainer.innerHTML = clothingItems.bottoms.map(item => `
              <div class="clothing-item cursor-pointer rounded-xl border-2 border-gray-200 p-4 transition-all hover:shadow-xl bg-white" 
                   data-id="${item.id}" onclick="selectItem(${JSON.stringify(item).replace(/"/g, '&quot;')}, 'bottom')">
                  <img src="${item.image}" alt="${item.name}" class="w-full h-24 object-cover rounded-lg mb-3 shadow-sm">
                  <div class="space-y-1">
                      <p class="font-semibold text-sm text-gray-800">${item.name}</p>
                      <p class="text-xs text-gray-500">${item.color} • ${item.brand}</p>
                      <div class="flex justify-between items-center">
                          <span class="inline-block bg-gradient-to-r from-blue-100 to-purple-100 text-blue-800 text-xs px-2 py-1 rounded-full font-medium">${item.category}</span>
                          <span class="text-xs font-bold text-green-600">${item.price}</span>
                      </div>
                  </div>
              </div>
          `).join('');

          // Renderizar shoes
          const shoesContainer = document.getElementById('shoes-container');
          shoesContainer.innerHTML = clothingItems.shoes.map(item => `
              <div class="clothing-item cursor-pointer rounded-xl border-2 border-gray-200 p-4 transition-all hover:shadow-xl bg-white" 
                   data-id="${item.id}" onclick="selectItem(${JSON.stringify(item).replace(/"/g, '&quot;')}, 'shoes')">
                  <img src="${item.image}" alt="${item.name}" class="w-full h-24 object-cover rounded-lg mb-3 shadow-sm">
                  <div class="space-y-1">
                      <p class="font-semibold text-sm text-gray-800">${item.name}</p>
                      <p class="text-xs text-gray-500">${item.color} • ${item.brand}</p>
                      <div class="flex justify-between items-center">
                          <span class="inline-block bg-gradient-to-r from-green-100 to-blue-100 text-green-800 text-xs px-2 py-1 rounded-full font-medium">${item.category}</span>
                          <span class="text-xs font-bold text-green-600">${item.price}</span>
                      </div>
                  </div>
              </div>
          `).join('');
      }

      // Renderizar comunidad mejorado
      function renderCommunity() {
          const communityContainer = document.getElementById('community-looks');
          communityContainer.innerHTML = communityLooks.map(look => `
              <div class="glass-card rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all">
                  <div class="p-4">
                      <div class="flex gap-4">
                          <div class="relative">
                              <img src="${look.image}" alt="${look.outfit}" class="w-24 h-32 object-cover rounded-xl shadow-lg">
                              ${look.trending ? '<div class="absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full font-bold">HOT</div>' : ''}
                          </div>
                          <div class="flex-1">
                              <div class="flex items-center gap-2 mb-2">
                                  <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                      ${look.avatar}
                                  </div>
                                  <div class="flex items-center gap-1">
                                      <span class="font-semibold text-sm">${look.user}</span>
                                      ${look.verified ? '<i class="fas fa-check-circle text-blue-500 text-xs"></i>' : ''}
                                  </div>
                              </div>
                              <p class="text-sm font-semibold mb-2 text-gray-800">${look.outfit}</p>
                              <div class="flex items-center justify-between">
                                  <div class="flex items-center gap-4">
                                      <button class="text-red-500 hover:text-red-600 flex items-center gap-1 text-sm font-medium transition-colors">
                                          <i class="fas fa-heart"></i>
                                          ${look.likes}
                                      </button>
                                      <button class="text-blue-500 hover:text-blue-600 flex items-center gap-1 text-sm font-medium transition-colors">
                                          <i class="fas fa-comment"></i>
                                          ${look.comments}
                                      </button>
                                  </div>
                                  <button class="text-gray-500 hover:text-gray-600 transition-colors">
                                      <i class="fas fa-share text-sm"></i>
                                  </button>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          `).join('');
      }

      // Simular clima mejorado
      function updateWeather() {
          const weatherData = [
              { temp: 18, condition: 'Fresco', icon: 'cloud' },
              { temp: 22, condition: 'Soleado', icon: 'sun' },
              { temp: 25, condition: 'Cálido', icon: 'sun' },
              { temp: 28, condition: 'Caluroso', icon: 'sun' },
              { temp: 15, condition: 'Frío', icon: 'snowflake' },
              { temp: 20, condition: 'Templado', icon: 'cloud-sun' },
              { temp: 24, condition: 'Agradable', icon: 'sun' }
          ];
          
          const randomWeather = weatherData[Math.floor(Math.random() * weatherData.length)];
          
          document.getElementById('weather-temp').textContent = randomWeather.temp + '°C';
          document.getElementById('weather-condition').textContent = randomWeather.condition;
          
          // Actualizar recomendación basada en clima
          updateAIRecommendation();
      }

      // Inicializar aplicación mejorada
      document.addEventListener('DOMContentLoaded', function() {
          renderClothing();
          renderCommunity();
          updateWeather();
          updateUserInterface();
          updateAIRecommendation();
          
          // Actualizar clima cada 5 minutos
          setInterval(updateWeather, 300000);
          
          // Mostrar tutorial si es primera visita
          if (!localStorage.getItem('tutorialShown')) {
              setTimeout(() => {
                  showTutorial();
                  localStorage.setItem('tutorialShown', 'true');
              }, 2000);
          }
      });
  </script>
</body>
</html>
